{{ define "main" }}

{{ .Content }}

{{/* Intro summary section */}}

{{ if or .Site.Params.homeIntroTitle .Site.Params.homeIntroContent .Site.Params.homeIntroImage }}
<div class="intro" style="display: flex; gap: 2rem; align-items: flex-start;">
    <div style="flex: 1;">
        {{ with .Site.Params.homeIntroTitle }}
        <h3 style="margin-top: 0;">{{ . }}</h3>
        {{ end }}

        {{ with .Site.Params.homeIntroContent }}
        <p>{{ . | markdownify }}</p>
        {{ end }}
        
        {{/* Social Icons */}}
        {{ with site.Params.social }}
        <div class="social-icons" style="margin-top: 1rem;">
            {{- range . }}
            <a href="{{ trim .url " " | safeURL }}" target="_blank"
                rel="noopener noreferrer me"
                title="{{ (.title | default .name) | title }}">
                {{ partial "svg.html" . }}
            </a>
            {{- end }}
        </div>
        {{ end }}
    </div>
    
    {{ with .Site.Params.homeIntroImage }}
    <div class="intro-image" style="flex: 0 0 350px;">
        <img src="{{ . }}" alt="Profile image" style="width: 100%; height: auto; border-radius: 8px;">
    </div>
    {{ end }}
</div>
{{ end }}

{{/* Collection Section */}}

{{ if .Site.Params.homeCollection }}

<div class="list-container">
    {{ with .Site.Params.homeCollectionTitle}}
    <h3> {{ . }} </h3>
    {{ end }}

    {{ $pages := where .Site.RegularPages "Section" .Site.Params.homeCollection
    }}

    {{ $paginationSize := 1}}
    {{ if (gt .Site.Params.paginationSize 0) }}
    {{ $paginationSize = .Site.Params.paginationSize }}
    {{ end }}

    {{ $paginator := .Paginate $pages $paginationSize }}

    {{ range $index, $page := $paginator.Pages }}
    {{ partial "post-entry.html" $page}}
    {{ end }}

    {{ partial "pagination-controls.html" $paginator}}

    {{ end }}
</div>

{{ end }}
